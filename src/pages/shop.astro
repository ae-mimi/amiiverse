---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getEntry } from "astro:content";

const shopPage = await getEntry("pages", "shop");
if (!shopPage) {
    throw new Error("Could not find 'shop' page content");
}
const { data } = shopPage;
---

<BaseLayout title={data.title || "Shop | amii"}>
    <div
        class="container"
        style="min-height: 60vh; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center;"
    >
        <h1 class="font-heading" style="font-size: 4rem; margin-bottom: 1rem;">
            {data.heading || "Shop"}
        </h1>
        <p style="font-size: 1.25rem; margin-bottom: 2rem;">
            {data.comingSoonText || "Official merchandise coming soon."}
        </p>

        <form
            id="sib-form"
            method="POST"
            action="https://ed72466f.sibforms.com/serve/MUIFAAJ8WKXFo5Q1TzmqXeTIEuOr9C2MqCf7Sk8QO8P2Bcfxh1y-zEBvNrzeWX5CPojpdcjKfmTdAkIvZR2cLAAakG_fBleyAcBZzU1NsPAsQBp8nqE3iHtGsUfi2fEtH2kIwAc6Ua4sa0QizCC-QwoTaaSOVu7mtrxaGhncBLZLgagxEk6jOSkdRon11sF4T2svc43r9spIC9Qhxw=="
            data-type="subscription"
            style="display: flex; flex-direction: column; gap: 1rem; max-width: 400px; width: 100%;"
        >
            <div class="form-group" style="width: 100%;">
                <input
                    type="text"
                    name="email_address_check"
                    value=""
                    class="input--hidden"
                    style="display:none;"
                />
                <input type="hidden" name="locale" value="en" />
                <input
                    type="email"
                    name="EMAIL"
                    class="form-input"
                    placeholder={data.placeholderText || "Get notified..."}
                    autocomplete="email"
                    required
                />
            </div>

            <button
                class="g-recaptcha btn w-full"
                data-sitekey="6LdNelgsAAAAADNsAjrG9RpKVklo64q7amBOZ2fk"
                data-callback="onShopSubmit"
                data-action="submit">{data.buttonText || "Join"}</button
            >

            <p
                style="font-size: 0.7rem; opacity: 0.7; margin-top: 0.5rem; text-align: center;"
            >
                This site is protected by reCAPTCHA and the Google
                <a
                    href="https://policies.google.com/privacy"
                    target="_blank"
                    rel="noopener noreferrer"
                    style="text-decoration: underline;">Privacy Policy</a
                > and
                <a
                    href="https://policies.google.com/terms"
                    target="_blank"
                    rel="noopener noreferrer"
                    style="text-decoration: underline;">Terms of Service</a
                > apply.
            </p>
        </form>
    </div>

    <!-- Scripts for reCAPTCHA -->
    <script is:inline src="https://www.google.com/recaptcha/api.js?hl=en"
    ></script>
    <script is:inline>
        function onShopSubmit(token) {
            document.getElementById("sib-form").submit();
        }
    </script>
</BaseLayout>
